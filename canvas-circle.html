<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

</head>
<body>
    <canvas id="i" width="610" height="610"></canvas>
    <script>
        var canvas = document.querySelector('#i');
        var context = canvas.getContext('2d');

        var radius = 120;
        var sinABase = 20;

        var timeV = 0;

        var interval = setInterval(it);

        //it();

        function it() {
            draw(getR(timeV++ / 5 / 180 * Math.PI));
        }

        function getR(timeV) {
            return Math.sin(timeV) * sinABase;
        }

        function draw(sinA) {
            canvas.width = canvas.width;
            context.beginPath();
            context.arc(300,300,radius,0,360,0);
            context.closePath();
            context.strokeStyle = "#8BDBFC";
            context.lineWidth='5';
            context.stroke();
            var wave = 4;
            var angleStart = 260;
            var angle = 500;
            var last = [-1, -1];
            //context.beginPath();
            var colorChangeThreshold = 5;
            for (var i=angleStart; i < angleStart+angle; ++i) {
                var p = ((i-angleStart) * wave * 540 / angle % 360);
                var cr = sinA * Math.sin(p / 180 * Math.PI) + radius;
                context.beginPath();
                if (last[0] > 0){
                    context.moveTo(last[0],last[1]);
                }
                var current = [Math.cos(i / 180 * Math.PI) * cr + 300, cr * Math.sin(i / 180 * Math.PI) + 300];
                context.lineTo(current[0], current[1]);
                if (Math.abs(cr - radius) < colorChangeThreshold) {
                    context.strokeStyle = "#8BDBFC";
                } else {
                    context.strokeStyle = "#F8EEF1";
                }
                context.stroke();
                context.closePath();
                last = current;
            }
        }
    </script>
</body>
</html>